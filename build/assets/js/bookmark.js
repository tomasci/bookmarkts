// bookmark.ts
// skyparadise.org, evgenyberezin.com

"use strict";window.onload=function(){new Bookmark({hoverZoneTimeout:100,scrollPosition:"center",scrollBehavior:"smooth",showPanelOnScroll:!0})};var Bookmark=function(){function e(e){this.settings=e,this.body=document.body,this.CreateHoverZone(),this.CreatePanel(),this.OnScrollEvent()}return e.prototype.CreateHoverZone=function(){var t=this,e=document.createElement("div");e.classList.add("bookmark-hoverzone"),e.addEventListener("mouseenter",function(e){return t.HandleHoverZone(e,t)}),this.bm_hzone=e,this.body.appendChild(this.bm_hzone)},e.prototype.CreatePanel=function(){var t=this,e=document.createElement("div");e.classList.add("bookmark-panel"),e.addEventListener("mouseleave",function(e){return t.HandlePanelZone(e,t)}),e.addEventListener("mouseover",function(e){t.mouse_over_panel=!0});var o=document.createElement("div");o.classList.add("bookmark-panel-container"),e.appendChild(o),this.bm_panel=e,this.bm_panel_container=o,this.LoadStructure(this.bm_panel_container),this.body.appendChild(this.bm_panel)},e.prototype.SelectAllBookmarks=function(){return document.querySelectorAll(".bookmark")},e.prototype.LoadStructure=function(t){var o=this;this.SelectAllBookmarks().forEach(function(e){t.appendChild(o.MakeAnchor(e))})},e.prototype.MakeAnchor=function(t){var o=this,e=document.createElement("a");return e.innerText=t.dataset.bookmarkTitle,e.href="#",e.addEventListener("click",function(e){e.preventDefault(),t.scrollIntoView({block:o.settings.scrollPosition,behavior:o.settings.scrollBehavior})}),e.style.top=this.GetAnchorPosition(t)+"%",e},e.prototype.HandleHoverZone=function(e,t){t.ShowPanel()},e.prototype.HandlePanelZone=function(e,t){t.HidePanel(),this.mouse_over_panel=!1},e.prototype.ShowPanel=function(){this.bm_hzone.style.display="none",this.bm_panel.classList.add("bookmark-show")},e.prototype.HidePanel=function(){var e=this;this.bm_panel.classList.remove("bookmark-show"),setTimeout(function(){e.bm_hzone.style.display="block"},this.settings.hoverZoneTimeout)},e.prototype.GetDocumentHeight=function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)},e.prototype.GetElementPosition=function(e){var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset}},e.prototype.GetAnchorPosition=function(e){var t=this.GetDocumentHeight();return 90*this.GetElementPosition(e).top/t},e.prototype.OnScrollEvent=function(){var t=this;document.addEventListener("scroll",function(e){window.clearTimeout(t.isScrolling),t.ShowPanel(),t.isScrolling=setTimeout(function(){t.mouse_over_panel||t.HidePanel()},700)})},e}();